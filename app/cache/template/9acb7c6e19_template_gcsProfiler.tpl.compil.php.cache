<!DOCTYPE html>
<html lang="fr">
    <head>
        <title>Profiler [<?php echo ($data['url']); ?>]</title>
        <meta charset="utf-8" />
        <link rel="icon" type="image/png" href="/<?php echo $this->path(RESOLVE_IMAGE); ?>logo.png" />
		<link href="<?php echo $this->getUrl('.gcs.gcs.assetManager.default', array('2d047826415b8b7c4d9b0b13db7373c81b1aef92','css')); ?>" rel="stylesheet" media="screen" type="text/css" />
    </head>
    <body>
		<header id="header">
			<div class="content">
				<h1 style="float:left">
					Profiler [<?php echo ($data['url']); ?>]
				</h1>
			</div>
		</header>
    	<div id="main">
        	<div class="content">
    		<form method="post" action="">
    			<input type="text" id="page" name="id" placeholder="<?php echo $this->useLang('gcs.profiler.page-id',array()); ?>"/>
    			<input type="submit" value="<?php echo $this->useLang('gcs.profiler.page-send',array()); ?>"/>
    		</form>
    		<br />
            <section>
                <div class="title">
                    <h3><?php echo $this->useLang('gcs.profiler.time',array()); ?> : <?php echo ($data['time']); ?> ms</h3>
                </div>
                <div class="content-section">
                    <ul>
                        <?php if(isset($data['timeUser'])) { foreach($data['timeUser'] as $key => $value) { ?>
                            <li><strong><?php echo ($key); ?></strong> : <?php echo ($value); ?></li>
                        <?php }} ?>
                    </ul>
                </div>
            </section>
            <section>
                <div class="title">
                    <h3><?php echo $this->useLang('gcs.profiler.request',array()); ?></h3>
                </div>
                <div class="content-section">
                    <?php  $request = unserialize($data['request']) ?>
                    <ul>
                        <li><strong>name</strong> : <?php echo ($request->name); ?></li>
                        <li><strong>src</strong> : <?php echo ($request->src); ?></li>
                        <li><strong>controller</strong> : <?php echo ($request->controller); ?></li>
                        <li><strong>action</strong> : <?php echo ($request->action); ?></li>
                        <li><strong>cache</strong> : <?php echo ($request->cache); ?></li>
                        <li><strong>logged</strong> : <?php echo ($request->logged); ?></li>
                        <li><strong>access</strong> : <?php echo ($request->access); ?></li>
                        <li><strong>method</strong> : <?php echo ($request->method); ?></li>
                        <li><strong>lang</strong> : <?php echo ($request->lang); ?></li>
                    </ul>
                </div>
            </section>
            <section>
                <div class="title">
                    <h3><?php echo $this->useLang('gcs.profiler.response',array()); ?></h3>
                </div>
                <div class="content-section">
                    <?php  $response = unserialize($data['response']);  ?>
                    <ul>
                        <li><strong><?php echo $this->useLang('gcs.profiler.response-status',array()); ?></strong> : <?php echo ($response->status()); ?></li>
                        <li><strong>Content Type : <?php echo ($response->contentType()); ?></li>
                        <li><strong>Headers :</strong>
                            <?php  printArray($response->header());  ?>
                        </li>
                    </ul>
                </div>
            </section>
            <section>
                <div class="title">
                    <h3><?php echo $this->useLang('gcs.profiler.sql',array()); ?></h3>
                </div>
                <div class="content-section">
                    <?php if(isset($data['sql'])) { foreach($data['sql'] as $key => $value) { ?>
                        <div class="query-header"><?php echo ($key); ?> (<?php echo ($value['time']); ?> ms)</div>
                        <div>
                            <pre><?php  
                                    $sql = preg_replace('#([\t]+)#isU', '', $value['query']);
                                    echo join("\n", array_map("trim", explode("\n", trim($sql))));
                                 ?></pre>
                        </div>
                    <?php }} ?>
                </div>
            </section>
            <section>
                <div class="title">
                    <h3><?php echo $this->useLang('gcs.profiler.template',array()); ?></h3>
                </div>
                <div class="content-section">
                    <ul>
                        <?php if(isset($data['template'])) { foreach($data['template'] as $key => $value) { ?>
                            <li><?php echo ($key); ?> (<?php echo ($value['time']); ?> ms)</li>
                        <?php }} ?>
                    </ul>
                </div>
            </section>
            <section>
                <div class="title">
                    <h3>GET</h3>
                </div>
                <div class="content-section">
                    <ul>
                        <?php  printArray($data['get']);  ?>
                    </ul>
                </div>
            </section>
            <section>
                <div class="title">
                    <h3>POST</h3>
                </div>
                <div class="content-section">
                    <?php  printArray($data['post']);  ?>
                </div>
            </section>
            <section>
                <div class="title">
                    <h3>SESSION</h3>
                </div>
                <div class="content-section">
                    <ul>
                        <?php  printArray($data['session']);  ?>
                    </ul>
                </div>
            </section>
            <section>
                <div class="title">
                    <h3>COOKIE</h3>
                </div>
                <div class="content-section">
                    <ul>
                        <?php  printArray($data['cookie']);  ?>
                    </ul>
                </div>
            </section>
            <section>
                <div class="title">
                    <h3>FILES</h3>
                </div>
                <div class="content-section">
                    <ul>
                        <?php  printArray($data['files']);  ?>
                    </ul>
                </div>
            </section>
            <section>
                <div class="title">
                    <h3>SERVER</h3>
                </div>
                <div class="content-section">
                    <ul>
                        <?php  printArray($data['server']);  ?>
                    </ul>
                </div>
            </section>
            <section>
                <div class="title">
                    <h3><?php echo $this->useLang('gcs.profiler.file',array()); ?></h3>
                </div>
                <div class="content-section">
                    <ul>
                        <?php if(isset($data['controller'])) { foreach($data['controller'] as $key => $value) { ?>
                            <li><?php echo ($value); ?></li>
                        <?php }} ?>
                    </ul>
                </div>
            </section>
        </div>
		</div>
        <script type="text/javascript">
            updateHeight();

            window.onresize = function(event) {
                updateHeight();
            };

            function updateHeight(){
                document.getElementById('main').style.height = window.innerHeight - document.getElementById('header').offsetHeight + "px";
                document.getElementById('page').style.width = window.innerWidth - 165 + "px";
            }

            function save(){
                document.getElementById('form').submit();
            }
        </script>
    </body>
</html>